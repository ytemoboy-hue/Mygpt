<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dark Mode Chat GUI â€” OpenAI Chat</title>
  <style>
    :root{--bg:#0a0f1b;--card:#111827;--muted:#9ca3af;--accent:#10b981;--glass:rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#071024 0%,#0b1220 100%);color:#e6eef8;display:flex;align-items:center;justify-content:center;padding:20px}
    .app{width:100%;max-width:900px;height:90vh;background:var(--card);border-radius:12px;box-shadow:0 10px 40px rgba(2,6,23,0.8);display:flex;overflow:hidden}
    .left{width:320px;border-right:1px solid rgba(255,255,255,0.03);padding:18px;box-sizing:border-box}
    .brand{font-weight:700;font-size:18px;margin-bottom:8px}
    .note{font-size:12px;color:var(--muted);margin-bottom:12px}
    .field{margin-bottom:10px}
    input[type=text],select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:var(--glass);color:inherit}
    button{background:var(--accent);border:none;color:#042018;padding:10px 12px;border-radius:8px;font-weight:700;cursor:pointer}
    .main{flex:1;display:flex;flex-direction:column}
    .messages{flex:1;padding:18px;overflow:auto;display:flex;flex-direction:column;gap:12px;background:linear-gradient(0deg, rgba(255,255,255,0.01), transparent)}
    .msg{max-width:78%;padding:12px;border-radius:10px;background:rgba(255,255,255,0.02)}
    .user{align-self:flex-end;background:linear-gradient(90deg, rgba(16,185,129,0.12), rgba(16,185,129,0.06));}
    .bot{align-self:flex-start;background:linear-gradient(90deg, rgba(99,102,241,0.06), rgba(99,102,241,0.03));}
    .composer{display:flex;padding:14px;border-top:1px solid rgba(255,255,255,0.02);gap:10px}
    textarea{flex:1;min-height:48px;max-height:150px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;resize:none}
    .small{font-size:12px;color:var(--muted)}
    .top-row{display:flex;gap:8px;margin-bottom:12px}
    .left .preset{display:flex;gap:6px;flex-direction:column}
    .preset button{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.03);padding:8px;border-radius:8px;text-align:left}
    .footer-note{font-size:12px;color:var(--muted);padding:8px}
    .loader{display:inline-block;width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.4);animation:blink 1s linear infinite}
    @keyframes blink{0%{opacity:0.2}50%{opacity:1}100%{opacity:0.2}}
    a.link{color:var(--accent);text-decoration:none}
  </style>
</head>
<body>
  <div class="app" role="application">
    <div class="left">
      <div class="brand">Dark Mode Chat</div>
      <div class="note">Paste your OpenAI API key here (never share it). This will connect directly to OpenAI and run in your browser.</div>

      <div class="field">
        <label class="small">API Key</label>
        <input id="key" type="text" placeholder="sk-..." />
      </div>

      <div class="field">
        <label class="small">Model name</label>
        <input id="model" type="text" value="gpt-4o-mini" />
      </div>

      <div class="field">
        <label class="small">Max tokens</label>
        <input id="maxt" type="text" value="800" />
      </div>

      <div class="field top-row">
        <button id="save">Save</button>
        <button id="clear">Clear Key</button>
      </div>

      <div class="preset">
        <label class="small">Presets</label>
        <button data-prompt="You are a helpful assistant.">Simple Assistant</button>
        <button data-prompt="You are a friendly tutor who explains things step-by-step.">Tutor</button>
        <button data-prompt="You are a short assistant; reply in 2-3 sentences.">Short Replies</button>
      </div>

      <div class="footer-note">Tip: For privacy, prefer creating a restricted API key or run a server proxy.</div>
    </div>

    <div class="main">
      <div style="padding:12px;border-bottom:1px solid rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:space-between">
        <div style="font-weight:700">Chat</div>
        <div class="small" id="status">Idle</div>
      </div>

      <div id="messages" class="messages" aria-live="polite"></div>

      <div class="composer">
        <textarea id="input" placeholder="Type your message..."></textarea>
        <div style="display:flex;flex-direction:column;gap:8px">
          <button id="send">Send</button>
          <button id="reset">Reset</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const keyInput = document.getElementById('key');
    const saveBtn = document.getElementById('save');
    const clearBtn = document.getElementById('clear');
    const modelInput = document.getElementById('model');
    const maxInput = document.getElementById('maxt');
    const messagesEl = document.getElementById('messages');
    const inputEl = document.getElementById('input');
    const sendBtn = document.getElementById('send');
    const resetBtn = document.getElementById('reset');
    const statusEl = document.getElementById('status');

    keyInput.value = localStorage.getItem('openai_key') || '';
    modelInput.value = localStorage.getItem('openai_model') || modelInput.value;
    maxInput.value = localStorage.getItem('openai_max') || maxInput.value;

    saveBtn.onclick = () => {
      localStorage.setItem('openai_key', keyInput.value.trim());
      localStorage.setItem('openai_model', modelInput.value.trim());
      localStorage.setItem('openai_max', maxInput.value.trim());
      alert('Saved locally.');
    }
    clearBtn.onclick = ()=>{ localStorage.removeItem('openai_key'); keyInput.value=''; alert('Key cleared'); }

    document.querySelectorAll('.preset button').forEach(b=>{
      b.onclick = ()=>{ addMessage('system', b.dataset.prompt); }
    })

    function addMessage(role, text){
      const el = document.createElement('div');
      el.className = 'msg ' + (role==='user'?'user':'bot');
      el.innerText = text;
      messagesEl.appendChild(el);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    async function callApi(messages){
      const apiKey = keyInput.value.trim();
      if(!apiKey){ alert('Please paste your API key in the left panel and Save.'); return null; }
      statusEl.innerHTML = 'Thinking <span class="loader"></span>';

      const body = {
        model: modelInput.value || 'gpt-4o-mini',
        messages: messages,
        max_tokens: parseInt(maxInput.value) || 800,
      };

      try{
        const res = await fetch('https://api.openai.com/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer ' + apiKey
          },
          body: JSON.stringify(body)
        });

        if(!res.ok){
          const errTxt = await res.text();
          throw new Error('API error: ' + res.status + ' ' + errTxt);
        }

        const j = await res.json();
        const out = j.choices && j.choices[0] && (j.choices[0].message?.content || j.choices[0].text) || JSON.stringify(j);
        statusEl.textContent = 'Idle';
        return out;
      } catch (err){
        statusEl.textContent = 'Error';
        alert('Request failed: ' + err.message);
        return null;
      }
    }

    sendBtn.onclick = async ()=>{
      const text = inputEl.value.trim();
      if(!text) return;
      addMessage('user', text);
      inputEl.value = '';

      const history = [];
      document.querySelectorAll('.msg').forEach(node=>{
        const r = node.classList.contains('user') ? 'user' : 'assistant';
        history.push({role: r, content: node.innerText});
      });

      const response = await callApi(history);
      if(response) addMessage('bot', response);
    }

    resetBtn.onclick = ()=>{ messagesEl.innerHTML=''; addMessage('bot','Hi, welcome! This chat box was created by Pratik Chauhan, your BCA college friend. My owner's Instagram handle: @Oy_prateekk. ðŸ˜‰'); }

    // initial welcome
    addMessage('bot','Hi, welcome! This chat box was created by Pratik Chauhan, your BCA college friend. My owner's Instagram handle: @Oy_prateekk. ðŸ˜‰');
  </script>
</body>
</html>
